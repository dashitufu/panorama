# panorama
实时全景 panorama stitch

	1，简介
	vs2022 + Cuda Tookit 12.9  降级应该没问题，没有什么高档的语句。

	不含视觉部分，自行求H矩阵与相机位姿。假定相机固定，这部分只需要求一次即可，后面持续用固定位姿。

	剥离 maxflow后，4060卡上运行时间16-19毫秒左右，我也不知为什么花那么多时间，全项目只有一个核函数超过1毫秒

  
	2，关于maxflow
	
		最大的耗时在maxflow上，因为纯在cpu上跑。没工夫去优化了，有需要再弄。思路有三
	
		1 重写maxflow的GPU版
		图论重增广路加预推流一共介绍了4，5种方法，找一种对GPU友好的方法猛干即可。
		缺点是要花时间做，破项目给不了充足时间。

		2 将maxflow预先做死
		在相机位姿不变与光照条件变化不大的情况下，缝合线可以假定固定。
		缺点是在光照条件改变下，有可能看出缝合线。

		3 多线程做Maxflow
		120毫秒不是问题，花4个线程可以做到实时。
		缺点是带来120毫秒的延迟，只能用于电视节目，实时要求高的情况下会身败名裂

	3，后续工作
		1，视觉部分
			做闭环了可以彻底摆脱第三方，工作很多，比如广角鱼眼，满血版畸变参数。强项喔

		2，投影
			从最终缝合出来的图可以看出，这是投影在sphere上的图，所以最终的屏幕应该是弧形才符合真实观感。
			
			实际上投影的需求很多，比如投到其他角度的墙上，这些都要进一步进行投影变换。
			


		
		
		
	
  
  
  
